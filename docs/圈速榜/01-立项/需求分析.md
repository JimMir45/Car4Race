# Car4Race 圈速榜 - 需求分析

## 1. 用户画像

### 1.1 目标用户

| 用户类型 | 描述 | 核心诉求 |
|----------|------|----------|
| **赛道日玩家** | 定期参加赛道日活动，追求圈速进步 | 记录每次练习成绩，对比进步 |
| **山路爱好者** | 喜欢跑山/峠道，享受驾驶乐趣 | 记录山路成绩，发现新路线 |
| **性能车车主** | 拥有性能车，关注车辆极限表现 | 了解同车型成绩，衡量自身水平 |
| **汽车爱好者** | 关注汽车性能，但不一定亲自下赛道 | 浏览榜单，了解各车型表现 |
| **俱乐部/车友会** | 组织赛道日活动的俱乐部 | 统一管理成员成绩，展示俱乐部形象 |
| **赛道日组织方** | 组织赛道日活动的机构 | 记录活动成绩，推广品牌 |
| **媒体/车评人** | 专业汽车媒体、自媒体 | 展示测试成绩，建立专属榜单 |

### 1.2 用户角色

| 角色 | 说明 | 权限范围 |
|------|------|----------|
| **游客** | 未登录用户 | 浏览榜单、查看成绩详情 |
| **注册用户** | 已登录用户 | 记录成绩、管理最佳、上榜、投票、标记山路、申请加入组织 |
| **组织成员** | 加入某组织的用户 | 在组织榜单记录成绩 |
| **组织管理员** | 组织的管理者 | 审批成员、审核成绩、管理组织信息 |
| **系统管理员** | 系统管理员 | 审核申诉、管理数据、维护爬虫、管理组织 |

---

## 2. 用户场景

### 场景一：赛道日后记录成绩

**用户**：小王，赛道日玩家，驾驶高尔夫R

**背景**：小王刚参加完浙赛赛道日，跑出了个人最佳 1:48.532

**流程**：
1. 打开 App，选择「记录成绩」
2. 选择赛道：浙江国际赛车场
3. 输入圈速：1:48.532
4. 填写车型：大众高尔夫R
5. 填写轮胎：米其林 PS4S
6. 选择改装程度：1（轻度改装）
7. 选择天气：晴
8. 上传成绩照片（官方计时截图）
9. 上传随车视频
10. 选择「公开上榜」
11. 等待投票验证

**预期结果**：成绩进入待验证队列，投票通过后出现在综合榜单

---

### 场景二：跑山后记录成绩

**用户**：老李，山路爱好者，驾驶86

**背景**：老李周末去了一条新发现的山路，想记录成绩

**流程**：
1. 打开 App，发现该山路尚未被标记
2. 选择「标记新山路」
3. 阅读并同意免责声明
4. 在地图上标记起点 GPS 坐标
5. 在地图上标记终点 GPS 坐标
6. 命名山路：「XX山南坡」
7. 保存山路标记
8. 开启 GPS 计时
9. 驾驶通过起点，自动开始计时
10. 驾驶通过终点，自动结束计时
11. 上传脱敏视频（无车牌、无人脸）
12. 保存成绩

**预期结果**：成绩保存到个人记录，山路可被其他用户使用

---

### 场景三：导入 RaceChrono 数据

**用户**：阿杰，使用 RaceChrono 记录的老用户

**背景**：阿杰有大量历史数据在 RaceChrono 中，想导入到圈速榜

**流程**：
1. 在 RaceChrono 中导出 CSV 文件
2. 打开圈速榜 App，选择「导入数据」
3. 上传 CSV 文件
4. 系统解析文件，展示识别到的成绩列表
5. 阿杰确认/修正车型、赛道等信息
6. 批量导入到个人记录

**预期结果**：历史成绩批量导入，可在个人记录中查看

---

### 场景四：为他人成绩投票

**用户**：小张，浙赛常客

**背景**：系统推送了一条待验证成绩，请求小张投票

**流程**：
1. 收到推送通知
2. 打开待验证成绩详情
3. 查看成绩照片（官方计时截图）
4. 观看随车视频
5. 判断成绩真伪
6. 投票：真 / 假

**预期结果**：投票计入统计，10 人投票完成后决定成绩是否上榜

---

### 场景五：浏览综合榜单

**用户**：车迷小刘

**背景**：小刘想看看浙赛的综合圈速榜

**流程**：
1. 打开 App，进入「榜单」页面
2. 选择赛道：浙江国际赛车场
3. 查看综合榜单（官方 + 大V + 个人）
4. 筛选车型：轿车 / 纯电 / 50-100万
5. 查看具体成绩详情（视频、改装信息等）

**预期结果**：看到该赛道、该车型分类下的所有成绩排名

---

### 场景六：申诉被作废的成绩

**用户**：小王

**背景**：小王的成绩被 5 票认定为假，成绩作废

**流程**：
1. 收到成绩作废通知
2. 查看投票详情
3. 提交申诉，补充说明材料
4. 等待管理员审核
5. 管理员审核通过，恢复上榜资格

**预期结果**：申诉成功后恢复上榜资格，成绩重新上榜

---

### 场景七：俱乐部管理成员成绩

**用户**：李总，某性能车俱乐部管理员

**背景**：李总的俱乐部每月组织一次浙赛赛道日，需要统一管理成员成绩

**流程**：
1. 李总登录后进入俱乐部管理后台
2. 查看待审核成绩列表
3. 打开某成员提交的成绩
4. 查看成绩照片和视频
5. 审核通过该成绩
6. 成绩进入俱乐部榜单

**预期结果**：成员成绩经审核后展示在俱乐部专属榜单

---

### 场景八：用户加入俱乐部

**用户**：小陈，某俱乐部的车友

**背景**：小陈想加入某性能车俱乐部，在俱乐部榜单记录成绩

**流程**：
1. 小陈搜索或通过链接找到该俱乐部页面
2. 点击「申请加入」
3. 填写申请留言
4. 提交申请
5. 等待俱乐部管理员审批
6. 收到审批通过通知
7. 成为俱乐部成员

**预期结果**：小陈成为俱乐部成员，可在俱乐部内记录成绩

---

### 场景九：俱乐部成员记录成绩

**用户**：小陈，某俱乐部成员

**背景**：小陈参加了俱乐部组织的浙赛赛道日，跑出了好成绩

**流程**：
1. 打开 App，选择俱乐部
2. 进入「记录成绩」
3. 选择赛道：浙江国际赛车场
4. 输入圈速：1:52.123
5. 填写车型和轮胎信息
6. 备注：2025年1月浙赛赛道日
7. 选择是否同步到综合榜单
8. 提交成绩，等待管理员审核

**预期结果**：成绩提交成功，等待管理员审核后进入俱乐部榜单

---

### 场景十：浏览俱乐部专属榜单

**用户**：车迷小刘

**背景**：小刘想看看某知名俱乐部的成绩榜单

**流程**：
1. 通过俱乐部专属链接打开榜单页面
2. 看到俱乐部 Logo 和品牌展示
3. 浏览该俱乐部成员的成绩
4. 按赛道/车型筛选成绩
5. 查看具体成绩详情

**预期结果**：看到该俱乐部的专属榜单，包含品牌展示和赞助商信息

---

## 3. 功能清单

### 3.1 功能全景图

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           Car4Race 圈速榜                                     │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │
│  │  个人记录    │  │  榜单系统    │  │  社区验证    │  │  组织系统    │        │
│  ├─────────────┤  ├─────────────┤  ├─────────────┤  ├─────────────┤        │
│  │ 成绩记录    │  │ 综合榜单    │  │ 成绩投票    │  │ 组织管理    │        │
│  │ 最佳管理    │  │ 官方榜单    │  │ 山路申诉    │  │ 成员管理    │        │
│  │ 数据导入    │  │ 大V榜单     │  │ 成绩申诉    │  │ 组织榜单    │        │
│  │ 历史查询    │  │ 组织榜单    │  │             │  │ 成绩审核    │        │
│  └─────────────┘  └─────────────┘  └─────────────┘  │ 品牌展示    │        │
│                                                      └─────────────┘        │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐                         │
│  │  场地管理    │  │  计时系统    │  │  数据爬取    │                         │
│  ├─────────────┤  ├─────────────┤  ├─────────────┤                         │
│  │ 赛道库      │  │ GPS计时     │  │ 官方成绩    │                         │
│  │ 山路标记    │  │ 起终点触发   │  │ 大V成绩     │                         │
│  │ 山路申诉    │  │ 成绩记录    │  │ 媒体测试    │                         │
│  └─────────────┘  └─────────────┘  └─────────────┘                         │
│                                                                              │
│  ┌─────────────┐  ┌─────────────┐                                           │
│  │  用户系统    │  │  管理后台    │                                           │
│  ├─────────────┤  ├─────────────┤                                           │
│  │ 登录注册    │  │ 申诉审核    │                                           │
│  │ (与HPA共用)  │  │ 数据维护    │                                           │
│  │             │  │ 爬虫监控    │                                           │
│  │             │  │ 组织管理    │                                           │
│  └─────────────┘  └─────────────┘                                           │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.2 MVP 功能清单

| 模块 | 功能 | 优先级 | 描述 |
|------|------|--------|------|
| **个人记录** | 成绩记录 | P0 | 手动录入单次练习成绩 |
| | 最佳成绩管理 | P0 | 查看/管理各赛道个人最佳 |
| | RaceChrono 导入 | P1 | 导入 CSV/JSON 数据文件 |
| | 历史记录查询 | P1 | 按时间/赛道筛选历史成绩 |
| **场地管理** | 赛道库 | P1 | 展示爬取的赛道列表 |
| | 山路标记 | P1 | GPS 标记起终点，自定义命名 |
| | 山路列表 | P1 | 浏览已标记的山路 |
| **计时系统** | GPS 计时 | P0 | 山路起终点触发自动计时 |
| | 免责声明 | P0 | 开启计时前必须同意 |
| **榜单系统** | 综合榜单 | P1 | 展示官方+大V+个人成绩 |
| | 车型筛选 | P1 | 按级别/动力/价格筛选 |
| | 成绩详情 | P1 | 查看照片、视频、改装信息 |
| **社区验证** | 成绩投票 | P1 | 10 人投票验证成绩真伪 |
| | 成绩申诉 | P2 | 用户对作废成绩发起申诉 |
| | 山路申诉 | P2 | 3 人申诉可修改山路标记 |
| **组织系统** | 组织创建与管理 | P1 | 平台创建组织，设置管理员 |
| | 组织成员管理 | P1 | 用户申请、管理员审批 |
| | 组织专属榜单 | P1 | 展示组织成员成绩 |
| | 组织成绩记录 | P1 | 成员在组织内记录成绩 |
| | 组织成绩审核 | P1 | 管理员审核成员成绩 |
| | 组织品牌展示 | P1 | Logo、封面、主题色、赞助商 |
| **数据爬取** | 官方成绩爬取 | P2 | 51GT3、赛道微博 |
| | 大V成绩爬取 | P2 | 键盘车神教、懂车帝 |
| **管理后台** | 申诉审核 | P2 | 管理员处理申诉 |
| | 爬虫监控 | P2 | 监控爬虫运行状态 |
| | 组织管理 | P1 | 创建/管理组织 |

---

## 4. 成绩记录字段

### 4.1 字段定义

| 字段 | 类型 | 必填 | 上榜必填 | 说明 |
|------|------|------|----------|------|
| lap_time | string | ✅ | ✅ | 圈速，格式 mm:ss.xxx |
| track_id | int | ✅ | ✅ | 赛道/山路 ID |
| car_brand | string | ✅ | ✅ | 车辆品牌 |
| car_model | string | ✅ | ✅ | 车辆型号 |
| tire_brand | string | ✅ | ✅ | 轮胎品牌 |
| tire_model | string | ✅ | ✅ | 轮胎型号 |
| mod_level | int | ✅ | ✅ | 改装程度 0-3 |
| weather | string | ✅ | ✅ | 天气条件 |
| timing_photo | string | ❌ | ✅ | 计时截图 URL |
| video_url | string | ❌ | ✅ | 随车视频 URL |
| driver_name | string | ❌ | ❌ | 驾驶人姓名（实名） |
| is_public | bool | ✅ | - | 是否公开上榜 |
| record_date | date | ✅ | ✅ | 成绩日期 |
| notes | string | ❌ | ❌ | 备注 |

### 4.2 改装程度说明

| 等级 | 名称 | 典型改装内容 |
|------|------|-------------|
| 0 | 原厂 | 完全原厂状态，仅更换同规格轮胎 |
| 1 | 轻度改装 | 刹车片/刹车油、避震、高性能轮胎 |
| 2 | 中度改装 | 轮毂、ECU 程序、进排气系统 |
| 3 | 赛化改装 | 防滚架、赛车座椅、拆除内饰、无限制 |

### 4.3 天气选项

| 选项 | 说明 |
|------|------|
| 晴 | 干燥路面，晴天 |
| 阴 | 干燥路面，阴天 |
| 雨 | 雨天，湿滑路面 |
| 湿地 | 非下雨，但路面潮湿 |

### 4.4 车型分类维度

**级别**：
- A00级（微型车）
- A0级（小型车）
- A级（紧凑型）
- B级（中型车）
- C级（中大型）
- D级（大型车）
- SUV
- MPV
- 跑车

**动力**：
- 燃油
- 纯电
- 混动

**价格区间**：
- 0-20万
- 20-50万
- 50-100万
- 100万+

---

## 5. 榜单数据结构

### 5.1 综合榜单组成

```
综合榜单（按赛道）
│
├── 官方成绩（来源标记：官方）
│   ├── 51GT3 赛事成绩
│   └── 赛道官方微博
│
├── 大V成绩（来源标记：大V）
│   ├── 键盘车神教 锐思榜
│   ├── 键盘车神教 金港榜
│   └── 懂车帝 实测榜
│
└── 个人成绩（来源标记：用户）
    └── 投票验证通过的用户成绩
```

### 5.2 榜单展示字段

| 字段 | 说明 |
|------|------|
| 排名 | 当前筛选条件下的排名 |
| 圈速 | mm:ss.xxx |
| 车型 | 品牌 + 型号 |
| 驾驶人 | 姓名（个人成绩）/ 媒体名（大V）/ - （官方） |
| 改装程度 | 0-3 级 |
| 轮胎 | 品牌 + 型号 |
| 来源 | 官方 / 大V / 用户 |
| 日期 | 成绩日期 |

---

## 6. 投票验证机制

### 6.1 流程设计

```
用户提交公开成绩
       │
       ▼
  系统检查必填项
  • 成绩照片 ✓
  • 随车视频 ✓
       │
       ▼
  进入「待验证」状态
       │
       ▼
  系统选取 10 名投票用户
  ┌────────────────────────┐
  │ 选取优先级：            │
  │ 1. 同赛道有成绩的用户   │
  │ 2. 近期活跃用户         │
  │ 3. 随机用户             │
  └────────────────────────┘
       │
       ▼
  推送投票请求
       │
       ▼
  等待投票（设置超时时间）
       │
       ▼
  统计投票结果
       │
   ┌───┴───┐
   │       │
 <5假    ≥5假
   │       │
   ▼       ▼
成绩上榜  成绩作废
          │
          ▼
     用户禁止上榜
          │
          ▼
      可发起申诉
```

### 6.2 投票规则

| 规则 | 说明 |
|------|------|
| 投票人数 | 10 人 |
| 投票选项 | 真 / 假 |
| 作废阈值 | ≥5 票「假」 |
| 投票超时 | 待定（如 72 小时） |
| 超时处理 | 待定（按已有投票判定 / 延长 / 作废） |

### 6.3 惩罚机制

| 情况 | 惩罚 |
|------|------|
| 成绩被判定为假 | 该成绩作废，不计入榜单 |
| 成绩被判定为假 | 用户丧失公开上榜资格 |
| 申诉成功 | 恢复上榜资格 |

---

## 7. 山路标记系统

### 7.1 标记流程

```
用户发现新山路
       │
       ▼
  检查是否已被标记
       │
   ┌───┴───┐
   │       │
  已标记  未标记
   │       │
   ▼       ▼
直接使用  创建新标记
              │
              ▼
         阅读免责声明
              │
              ▼
         同意免责声明
              │
              ▼
         在地图上标记起点（GPS）
              │
              ▼
         在地图上标记终点（GPS）
              │
              ▼
         输入山路名称
              │
              ▼
         保存标记
              │
              ▼
         标记生效，其他用户可使用
```

### 7.2 标记规则

| 规则 | 说明 |
|------|------|
| 唯一性 | 同一路段只能被一人标记 |
| 判定标准 | 起终点 GPS 坐标重叠度 > 阈值视为同一路段 |
| 命名权 | 创建者自定义命名 |
| 共享 | 标记后其他用户可直接使用 |

### 7.3 申诉机制

| 步骤 | 说明 |
|------|------|
| 发起条件 | 3 名用户认为标记不合理 |
| 申诉理由 | 起终点位置错误 / 命名不当 / 重复标记 |
| 审核 | 管理员审核 |
| 处理结果 | 取消标记 / 修改标记 / 驳回申诉 |
| 公示 | 申诉条件和进度公开 |

---

## 8. 山路计时与合规

### 8.1 免责声明要点

用户在开启山路计时功能前，必须阅读并同意以下免责声明：

1. **非法定赛道**：山路为公共道路，非封闭赛道
2. **自担风险**：所有驾驶行为由用户自行承担风险
3. **遵守交规**：用户应遵守当地交通法规
4. **平台免责**：平台仅提供记录工具，不鼓励违法行为
5. **视频脱敏**：上传视频不得包含车牌、人脸等可识别信息
6. **法律后果**：如因视频内容被举报或追责，由用户自行承担

### 8.2 计时流程

1. 用户同意免责声明
2. 选择已标记的山路
3. 开启 GPS 计时功能
4. 系统持续获取 GPS 位置
5. GPS 进入起点范围 → 开始计时
6. GPS 进入终点范围 → 结束计时
7. 显示成绩，提示上传视频

### 8.3 视频要求

| 要求 | 说明 |
|------|------|
| 脱敏 | 不得出现车牌号 |
| 脱敏 | 不得出现人脸 |
| 提示 | 上传前提醒用户检查脱敏 |
| 责任 | 因视频内容被追责，由用户承担 |

---

## 9. 数据爬取需求

### 9.1 数据源

| 数据源 | URL | 数据类型 | 优先级 |
|--------|-----|----------|--------|
| 51GT3 | https://51gt3.com | 赛事成绩、车手数据 | P2 |
| 键盘车神教 | https://kbracer.github.io | 锐思榜、金港榜 | P2 |
| 赛道官方微博 | 各赛道微博账号 | 官方成绩 | P2 |
| 懂车帝实测榜 | https://www.dongchedi.com | 媒体测试成绩 | P2 |

### 9.2 爬取频率

| 配置 | 值 |
|------|-----|
| 执行时间 | 每日凌晨 5:00 |
| 频率 | 每天一次 |

### 9.3 爬取字段

| 字段 | 说明 |
|------|------|
| track_name | 赛道名称 |
| lap_time | 圈速 |
| car_info | 车型信息 |
| driver_name | 驾驶人/媒体名称 |
| tire_info | 轮胎信息 |
| mod_level | 改装程度 |
| source | 数据来源 |
| source_url | 原始链接 |
| record_date | 成绩日期 |

---

## 10. 用户故事

### 10.1 成绩记录

```gherkin
Feature: 成绩记录

  Scenario: 用户手动记录赛道成绩
    Given 用户已登录
    When 用户进入「记录成绩」页面
    And 选择赛道「浙江国际赛车场」
    And 输入圈速「1:48.532」
    And 填写车型「大众 高尔夫R」
    And 填写轮胎「米其林 PS4S」
    And 选择改装程度「1」
    And 选择天气「晴」
    And 点击「保存」
    Then 成绩保存成功
    And 成绩出现在个人记录列表

  Scenario: 用户记录成绩并公开上榜
    Given 用户已登录
    And 用户完成成绩基本信息填写
    When 用户勾选「公开上榜」
    Then 系统提示上传成绩照片和视频
    When 用户上传成绩照片
    And 用户上传随车视频
    And 点击「提交」
    Then 成绩进入「待验证」状态
    And 系统分配投票用户
```

### 10.2 GPS 计时

```gherkin
Feature: GPS 计时

  Scenario: 用户使用 GPS 计时跑山路
    Given 用户已登录
    And 用户已同意免责声明
    And 用户选择了已标记的山路
    When 用户开启 GPS 计时
    And 用户 GPS 位置进入起点范围
    Then 系统开始计时
    When 用户 GPS 位置进入终点范围
    Then 系统停止计时
    And 显示圈速成绩
    And 提示用户保存成绩
```

### 10.3 投票验证

```gherkin
Feature: 投票验证

  Scenario: 用户为他人成绩投票
    Given 用户已登录
    And 用户在该赛道有成绩记录
    When 系统推送待验证成绩
    And 用户查看成绩详情（照片、视频）
    And 用户判断成绩真实
    And 用户点击「真」
    Then 投票记录成功
    And 投票计入统计

  Scenario: 成绩被判定为假
    Given 某成绩正在投票验证
    When 10 名用户完成投票
    And 5 票及以上投「假」
    Then 成绩被判定为假
    And 成绩作废，不计入榜单
    And 用户丧失公开上榜资格
    And 通知用户可发起申诉
```

### 10.4 山路标记

```gherkin
Feature: 山路标记

  Scenario: 用户标记新山路
    Given 用户已登录
    And 用户在某山路位置
    And 该路段尚未被标记
    When 用户选择「标记新山路」
    And 用户阅读并同意免责声明
    And 用户在地图上标记起点
    And 用户在地图上标记终点
    And 用户输入山路名称「XX山南坡」
    And 用户点击「保存」
    Then 山路标记成功
    And 其他用户可使用该山路

  Scenario: 用户申诉山路标记
    Given 某山路已被用户A标记
    And 用户B、C、D认为标记不合理
    When 3 人发起申诉
    Then 申诉进入审核队列
    And 公示申诉进度
    When 管理员审核通过
    Then 取消/修改原标记
    And 通知相关用户
```

### 10.5 组织成员管理

```gherkin
Feature: 组织成员管理

  Scenario: 用户申请加入组织
    Given 用户已登录
    And 用户不是该组织成员
    When 用户访问组织页面
    And 用户点击「申请加入」
    And 用户填写申请留言
    And 用户点击「提交」
    Then 申请提交成功
    And 组织管理员收到通知

  Scenario: 组织管理员审批加入申请
    Given 管理员已登录
    And 有待审批的加入申请
    When 管理员查看申请详情
    And 管理员点击「通过」
    Then 用户成为组织成员
    And 用户收到通知
```

### 10.6 组织成绩记录

```gherkin
Feature: 组织成绩记录

  Scenario: 组织成员记录成绩
    Given 用户已登录
    And 用户是某组织的成员
    When 用户进入组织成绩记录页面
    And 用户填写成绩信息
    And 用户选择是否同步到综合榜单
    And 用户点击「提交」
    Then 成绩提交成功
    And 成绩进入待审核状态

  Scenario: 组织管理员审核成绩
    Given 管理员已登录
    And 有待审核的成绩
    When 管理员查看成绩详情（照片、视频）
    And 管理员点击「通过」
    Then 成绩审核通过
    And 成绩进入组织榜单

  Scenario: 组织成绩同步到综合榜单
    Given 成员提交成绩时选择了「同步到综合榜单」
    And 组织管理员审核通过
    Then 系统自动创建公开成绩
    And 公开成绩进入投票验证流程
```

### 10.7 组织品牌管理

```gherkin
Feature: 组织品牌管理

  Scenario: 管理员更新组织品牌信息
    Given 管理员已登录
    When 管理员进入组织设置页面
    And 管理员上传 Logo
    And 管理员上传封面图
    And 管理员设置主题色
    And 管理员点击「保存」
    Then 品牌信息更新成功
    And 组织榜单页面展示新的品牌信息

  Scenario: 管理员添加赞助商
    Given 管理员已登录
    When 管理员进入赞助商管理页面
    And 管理员点击「添加赞助商」
    And 管理员填写赞助商名称
    And 管理员上传赞助商 Logo
    And 管理员填写赞助商链接
    And 管理员点击「保存」
    Then 赞助商添加成功
    And 赞助商展示在组织榜单页面
```

---

## 11. 非功能需求

### 11.1 性能需求

| 指标 | 要求 |
|------|------|
| 页面加载 | < 3 秒 |
| GPS 定位精度 | < 10 米 |
| 计时精度 | < 1 秒误差 |
| 并发用户 | 待定 |

### 11.2 安全需求

| 需求 | 说明 |
|------|------|
| 用户认证 | 与 HPA 共用 JWT 认证 |
| 数据传输 | HTTPS 加密 |
| 视频存储 | 私有存储，防止外链 |
| 投票防刷 | 同一用户不能重复投票 |

### 11.3 合规需求

| 需求 | 说明 |
|------|------|
| 免责声明 | 山路计时前必须同意 |
| 视频脱敏 | 提醒用户不得包含车牌、人脸 |
| 爬虫合规 | 遵守 robots.txt，合理频率 |

---

## 12. 约束与依赖

### 12.1 技术约束

| 约束 | 说明 |
|------|------|
| 技术栈 | 与 HPA 保持一致（Go + Vue3 + SQLite） |
| 用户体系 | 与 HPA 共用 |
| 部署 | Docker 容器化 |

### 12.2 外部依赖

| 依赖 | 说明 | 风险 |
|------|------|------|
| GPS 定位 | 依赖设备 GPS 精度 | 精度不足影响计时 |
| 爬虫目标网站 | 依赖目标网站稳定 | 网站改版导致爬虫失效 |
| RaceChrono 数据格式 | 依赖其导出格式 | 格式变化需适配 |

### 12.3 业务约束

| 约束 | 说明 |
|------|------|
| 赛道库 | 爬取为主，用户不可新增 |
| 山路 | 用户标记，同一路段只能一人标记 |
| 投票 | 必须 10 人，5 票假则作废 |
